---
layout: post
title: ESP
feature-img:
categories: IoT
tags: [iot, lora, linux, esp, heltec, heltec-v3, esp32, esp8266]
---

ESP are cool. Let s bend them to our needs.

# ESP

## LoRa

### Heltec v3

#### Linux setup

First you ll need Python and Pip installed. You ll figure it out.  
Then install esptool

```bash
yay -S esptool
```

Clone the repo :
```bash
git clone git@github.com:meshtastic/firmware.git
cd firmware
git switch tags/v2.5.19.f9876cf # which is the latest tag at the moment, adapt
```

#### Da build
in order to build and especially upload, we ll use Platformio. I tried to install it system wide, it did compile the firmware, but during the upload process, it tried to pip-install some modules and failed. Therefore I would recommend the following :


```bash
# Setting up the env
uv venv .venv
source .venv/bin/activate
uv pip install platformio

# Now We can play with pio
pio system info
pio pkg list

# List all available envs
pio project config | grep env: [ | grep heltec ]

# Teh build
pio run -e heltec-v3

# Teh upload
pio run -e heltec-v3 -t upload --upload-port /dev/ttyUSB0
```

#### Bonus
Change the name on the splash screen.  
Edit the following file : src/graphics/Screen.cpp.
Around line 168, look for 'const char *title = "meshtastic.org";' and replace it by whatever name you want.  
Side note :  
The line before is : "#ifdef USERPREFS_SPLASH_TITLE", so I am pretty sure there is better way to make a custom splashscreen

### T114

The process is pretty similar. I had an issue while trying to upload the firmware using the USB port, as it seemed that none was found (plug on the same port as before, using the same cable). By removing the --upload-port, it worked, using /dev/ttyACM0. I am not sure why one is discovered on the USB port and the other on the ACM port.
```bash
pio run -e heltec-mesh-node-t114 -t upload
```
Edit : This difference would come from the different chip used on the board. Heltec v3 is using a USB-UART converter and appears on USB, whereas the t114 uses native USB (CDC-ACM) and appears on ACM.
